<!DOCTYPE html>
<html>

<head>
    <title>
        SpaceStory
    </title>
    <link rel="shortcut icon" type="image/png" href="images/favicon.png" />
    <style>
        body {
            background-color: #c0c0c0;
            overflow: hidden;
            touch-action: manipulation;
        }
    </style>
    <link rel="stylesheet" href="nametext.css">
    <meta name="viewport"
        contet="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, user-scalable=0">
    <script>
        var astroColsArray = [];
        //astroColsArray = [0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2];
        var idsArray = [];
        var column1ids = [];
        var column2ids = [];
        var column3ids = [];
        var score = 0;
        var url = window.location.href;
        var urlSearcher = new URLSearchParams(url);
        //var mapName = urlSearcher.get("level_name");
        var levelId = urlSearcher.get("level_id");
        //console.log(mapName);
        console.log(levelId);
        switch (levelId) {
            case "1":
                astroColsArray = [2, 1, 2, 1, 1, 2, 1, 1, 1, 0, 2, 0,
                    2, 1, 2, 2, 1, 2, 0, 2, 0, 2, 2, 0,
                    1, 2, 1, 0, 1, 0, 0, 2, 1, 1, 1, 1,
                    0, 0, 2, 1, 2, 0, 2, 1, 1, 0, 0, 1,
                    1, 2, 2, 0, 0, 1, 0, 1, 1, 0, 0, 0,
                    2, 0, 0, 0, 2, 1, 0, 1, 2, 1, 2, 1,
                    2, 0, 2];
                break;
            case "2":
                astroColsArray = [
                    0, 1, 2, 2, 2, 1, 0, 2, 1, 0, 1, 1,
                    0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 1, 1,
                    1, 2, 0, 2, 0, 2, 0, 2, 0, 0, 0, 1,
                    1, 1, 1, 0, 1, 2, 2, 0, 0, 1, 0, 2,
                    2, 2, 0, 1, 1, 1, 2, 0, 2, 2, 1, 0,
                    1, 2, 1, 2, 1, 0, 0, 0, 1, 0, 2, 0,
                    1, 2, 2
                ];
                break;
            case '3':
                astroColsArray = [
                    2, 1, 0, 0, 2, 0, 2, 1, 2, 0, 0, 1,
                    2, 2, 2, 1, 0, 0, 2, 1, 2, 2, 2, 0,
                    2, 2, 2, 2, 1, 0, 2, 0, 0, 1, 0, 2,
                    1, 1, 1, 2, 2, 0, 1, 2, 2, 1, 1, 2,
                    2, 1, 0, 2, 2, 2, 1, 0, 2, 2, 0, 1,
                    2, 2, 2, 1, 1, 1, 1, 2, 0, 0, 0, 0,
                    1, 2, 0
                ];
                break;
            case '4':
                astroColsArray = [
                    0, 1, 2, 0, 2, 0, 0, 2, 0, 1, 1, 0,
                    2, 0, 2, 1, 0, 0, 2, 2, 0, 2, 2, 0,
                    0, 0, 2, 2, 1, 0, 2, 1, 1, 0, 1, 1,
                    2, 0, 2, 1, 2, 0, 0, 0, 1, 0, 0, 2,
                    0, 2, 1, 0, 0, 2, 2, 0, 0, 2, 1, 0,
                    2, 0, 0, 1, 0, 1, 1, 1, 1, 0, 2, 1,
                    2, 0, 2
                ];
                break;
            case '5':
                astroColsArray = [
                    1, 2, 2, 1, 2, 0, 2, 0, 2, 1, 0, 0,
                    0, 1, 0, 1, 1, 2, 2, 1, 0, 2, 0, 0,
                    1, 2, 1, 0, 1, 2, 0, 1, 2, 2, 2, 1,
                    2, 1, 2, 2, 1, 1, 2, 1, 2, 0, 2, 0,
                    2, 0, 1, 2, 0, 2, 1, 0, 1, 2, 0, 0,
                    1, 1, 1, 2, 2, 0, 1, 0, 0, 2, 1, 1,
                    2, 1, 2
                ];
                break;
            case '6':
                astroColsArray = [
                    1, 2, 2, 2, 0, 1, 1, 2, 0, 1, 2, 1,
                    1, 0, 1, 0, 2, 1, 2, 0, 0, 0, 1, 0,
                    1, 2, 0, 0, 1, 2, 1, 2, 2, 0, 2, 1,
                    2, 2, 0, 0, 1, 2, 2, 2, 1, 2, 1, 0,
                    2, 0, 2, 2, 1, 0, 2, 2, 2, 1, 1, 1,
                    2, 1, 2, 2, 0, 2, 1, 0, 2, 2, 0, 0,
                    1, 2, 1
                ];
                break;
            case '7':
                astroColsArray = [
                    1, 2, 0, 2, 0, 0, 2, 2, 1, 2, 0, 1,
                    2, 0, 2, 0, 0, 2, 2, 0, 2, 2, 2, 0,
                    1, 2, 0, 1, 2, 0, 1, 1, 0, 0, 1, 2,
                    1, 1, 2, 0, 2, 1, 2, 0, 1, 2, 2, 1,
                    0, 0, 2, 0, 2, 2, 2, 0, 0, 0, 2, 1,
                    1, 1, 1, 1, 0, 1, 2, 0, 2, 2, 1, 2,
                    0, 2, 2
                ];
                break;
            case '8':
                astroColsArray = [
                    1, 2, 2, 0, 2, 0, 2, 2, 1, 2, 1, 0,
                    2, 1, 1, 1, 1, 2, 2, 0, 0, 1, 0, 1,
                    1, 1, 1, 2, 0, 0, 0, 0, 0, 0, 2, 2,
                    0, 1, 1, 2, 2, 2, 1, 1, 1, 0, 2, 1,
                    2, 2, 1, 1, 0, 1, 2, 0, 0, 2, 2, 1,
                    1, 0, 0, 0, 2, 2, 0, 2, 2, 0, 2, 2,
                    1, 0, 2
                ];
                break;
            case '9':
                astroColsArray = [
                    0, 0, 1, 2, 0, 1, 1, 1, 0, 2, 1, 0,
                    2, 2, 1, 1, 1, 0, 0, 2, 1, 2, 1, 2,
                    2, 1, 2, 2, 0, 0, 0, 2, 2, 1, 2, 0,
                    2, 0, 1, 2, 0, 1, 0, 2, 0, 2, 2, 1,
                    2, 1, 2, 0, 0, 1, 0, 2, 0, 0, 1, 1,
                    1, 1, 2, 2, 0, 2, 2, 1, 1, 2, 2, 2,
                    1, 0, 0
                ];
                break;
            case '10':
                astroColsArray = [
                    2, 2, 0, 1, 2, 0, 1, 0, 2, 0, 0, 1,
                    2, 1, 2, 0, 0, 0, 0, 0, 0, 1, 0, 1,
                    0, 0, 2, 2, 0, 0, 0, 1, 2, 2, 0, 2,
                    2, 1, 2, 2, 2, 0, 1, 2, 0, 0, 1, 2,
                    0, 0, 1, 1, 2, 1, 0, 0, 2, 0, 2, 1,
                    1, 1, 0, 2, 1, 1, 1, 2, 0, 1, 1, 1,
                    0, 2, 2
                ];
                break;
            case '11':
                astroColsArray = [
                    1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0,
                    1, 2, 1, 1, 1, 2, 2, 1, 2, 0, 1, 1,
                    2, 2, 1, 0, 1, 0, 1, 1, 2, 1, 1, 2,
                    1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 0,
                    2, 2, 0, 1, 1, 2, 0, 1, 1, 1, 0, 1,
                    1, 0, 0, 1, 1, 0, 2, 0, 0, 0, 1, 2,
                    0, 2, 2
                ];
                break;
            case '12':
                astroColsArray = [
                    0, 1, 2, 2, 0, 2, 1, 0, 0, 1, 1, 0,
                    0, 1, 0, 0, 0, 1, 1, 2, 2, 2, 0, 1,
                    1, 2, 2, 0, 1, 0, 2, 1, 2, 0, 0, 0,
                    1, 0, 1, 1, 0, 2, 0, 0, 2, 0, 0, 2,
                    0, 1, 2, 0, 0, 1, 0, 1, 0, 1, 2, 0,
                    0, 0, 0, 2, 2, 2, 0, 0, 1, 2, 2, 1,
                    1, 2, 1
                ];
                break;
            case '13':
                astroColsArray = [
                    2, 1, 2, 2, 0, 0, 0, 2, 0, 0, 1, 0,
                    2, 2, 1, 0, 1, 2, 0, 2, 1, 2, 1, 1,
                    2, 1, 2, 2, 1, 2, 1, 2, 0, 2, 0, 1,
                    2, 2, 0, 0, 1, 0, 0, 2, 2, 2, 1, 2,
                    2, 2, 1, 1, 2, 2, 0, 0, 1, 2, 1, 1,
                    2, 0, 0, 2, 0, 1, 0, 0, 2, 2, 0, 1,
                    1, 2, 0
                ];
                break;
            case '14':
                astroColsArray = [
                    2, 1, 1, 0, 0, 2, 0, 1, 0, 1, 0, 0,
                    1, 2, 2, 1, 1, 1, 0, 1, 0, 2, 1, 2,
                    0, 1, 0, 1, 0, 0, 2, 2, 1, 2, 1, 2,
                    2, 1, 1, 2, 2, 0, 0, 1, 2, 1, 2, 2,
                    2, 0, 1, 1, 0, 0, 0, 2, 2, 0, 2, 2,
                    0, 1, 1, 0, 2, 0, 1, 0, 2, 1, 2, 1,
                    0, 2, 1
                ];
                break;
            case '15':
                astroColsArray = [
                    0, 1, 1, 0, 1, 2, 2, 1, 1, 1, 0, 1,
                    1, 0, 1, 1, 0, 2, 0, 0, 1, 1, 0, 1,
                    0, 0, 0, 2, 2, 2, 0, 0, 2, 1, 2, 1,
                    2, 1, 1, 2, 1, 2, 0, 0, 1, 2, 0, 1,
                    2, 2, 0, 2, 1, 2, 0, 2, 0, 2, 0, 2,
                    1, 2, 0, 0, 0, 2, 2, 1, 2, 0, 1, 0,
                    0, 2, 0
                ];
                break;
            case '16':
                astroColsArray = [
                    0, 2, 0, 1, 2, 0, 2, 1, 2, 0, 2, 2,
                    0, 2, 0, 1, 1, 2, 2, 1, 0, 0, 0, 1,
                    1, 0, 1, 2, 2, 2, 2, 0, 1, 2, 2, 1,
                    0, 1, 1, 2, 2, 1, 2, 2, 2, 2, 0, 2,
                    0, 2, 1, 2, 2, 0, 2, 2, 1, 2, 2, 2,
                    2, 1, 2, 2, 1, 2, 2, 1, 2, 0, 1, 2,
                    1, 2, 0
                ];
                break;
            case '17':
                astroColsArray = [
                    2, 1, 2, 2, 1, 0, 0, 1, 2, 0, 0, 0,
                    2, 2, 1, 2, 2, 1, 0, 1, 0, 2, 2, 1,
                    1, 0, 2, 1, 2, 2, 2, 2, 2, 1, 1, 2,
                    1, 0, 0, 2, 2, 1, 2, 1, 1, 2, 0, 1,
                    2, 2, 1, 2, 2, 2, 1, 2, 2, 1, 1, 0,
                    2, 1, 2, 0, 1, 1, 0, 1, 2, 2, 2, 2,
                    1, 0, 2
                ];
                break;
            case '18':
                astroColsArray = [
                    0, 0, 2, 1, 2, 2, 1, 1, 1, 1, 2, 2,
                    1, 0, 2, 0, 0, 2, 2, 1, 2, 1, 1, 0,
                    2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 2, 1,
                    0, 0, 2, 2, 0, 2, 1, 2, 2, 0, 2, 1,
                    2, 0, 1, 0, 2, 0, 1, 2, 1, 2, 0, 0,
                    1, 1, 1, 2, 2, 2, 0, 1, 1, 0, 2, 2,
                    0, 1, 2
                ];
                break;
            case '19':
                astroColsArray = [
                    2, 2, 2, 0, 1, 1, 0, 2, 1, 1, 1, 0,
                    0, 2, 1, 2, 2, 0, 2, 1, 0, 0, 2, 0,
                    0, 1, 1, 2, 0, 2, 0, 0, 0, 0, 1, 1,
                    2, 2, 2, 0, 0, 1, 0, 1, 0, 0, 2, 1,
                    0, 2, 2, 2, 2, 0, 2, 0, 1, 1, 2, 0,
                    0, 2, 1, 1, 0, 1, 2, 0, 2, 0, 2, 0,
                    2, 0, 0
                ];
                break;
            case '20':
                astroColsArray = [
                    0, 1, 0, 2, 0, 0, 1, 2, 2, 1, 2, 0,
                    2, 2, 1, 0, 1, 1, 2, 2, 2, 0, 1, 1,
                    0, 2, 1, 2, 2, 0, 2, 2, 2, 0, 0, 0,
                    2, 2, 2, 1, 2, 2, 2, 1, 1, 1, 0, 2,
                    1, 0, 2, 2, 1, 2, 1, 0, 1, 2, 1, 0,
                    0, 2, 2, 2, 1, 1, 0, 1, 1, 0, 1, 1,
                    1, 2, 0
                ];
                break;
            case '21':
                astroColsArray = [
                    2, 1, 2, 2, 1, 1, 2, 1, 0, 0, 2, 2,
                    2, 0, 1, 2, 2, 2, 2, 0, 2, 0, 2, 2,
                    1, 1, 0, 2, 1, 0, 0, 0, 2, 2, 1, 0,
                    0, 2, 2, 1, 0, 1, 2, 1, 2, 0, 2, 2,
                    1, 2, 2, 2, 1, 0, 2, 2, 1, 0, 1, 1,
                    0, 0, 0, 0, 1, 1, 1, 1, 2, 1, 0, 2,
                    2, 1, 1
                ];
                break;
            case '22':
                astroColsArray = [
                    1, 2, 2, 1, 1, 1, 0, 1, 0, 1, 1, 0,
                    0, 2, 2, 0, 1, 1, 1, 0, 2, 0, 2, 0,
                    0, 2, 2, 2, 1, 1, 2, 2, 1, 1, 0, 2,
                    0, 1, 0, 2, 1, 2, 2, 2, 0, 1, 2, 1,
                    0, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, 1,
                    1, 2, 0, 1, 2, 0, 1, 0, 1, 2, 2, 2,
                    1, 2, 2
                ];
                break;
            case '23':
                astroColsArray = [
                    2, 2, 0, 1, 0, 2, 2, 0, 1, 2, 2, 1,
                    2, 0, 1, 1, 2, 1, 2, 2, 2, 2, 0, 2,
                    2, 2, 1, 2, 2, 2, 1, 1, 0, 0, 0, 1,
                    1, 1, 2, 1, 1, 2, 2, 2, 0, 1, 1, 2,
                    1, 2, 2, 0, 2, 0, 0, 2, 2, 2, 2, 2,
                    2, 0, 1, 1, 2, 1, 2, 2, 1, 2, 0, 1,
                    2, 0, 2
                ];
                break;
            case '24':
                astroColsArray = [
                    2, 2, 2, 0, 0, 2, 2, 1, 2, 2, 1, 2,
                    2, 0, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1,
                    1, 2, 2, 2, 0, 1, 2, 0, 2, 0, 2, 2,
                    1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 2, 1,
                    2, 1, 0, 1, 0, 2, 1, 0, 0, 2, 2, 1,
                    0, 2, 0, 1, 2, 1, 0, 0, 1, 0, 0, 0,
                    1, 2, 0
                ];
                break;
            case '25':
                astroColsArray = [
                    0, 2, 1, 1, 2, 2, 1, 2, 0, 1, 2, 1,
                    0, 0, 2, 2, 0, 2, 2, 2, 1, 0, 1, 2,
                    0, 1, 1, 0, 2, 0, 0, 0, 2, 1, 0, 1,
                    1, 2, 2, 2, 2, 2, 0, 0, 1, 1, 1, 1,
                    0, 2, 2, 1, 2, 2, 2, 1, 0, 0, 2, 1,
                    2, 2, 2, 0, 1, 1, 2, 2, 0, 0, 2, 2,
                    2, 0, 0
                ];
                break;
            case '26':
                astroColsArray = [
                    2, 2, 0, 2, 2, 2, 1, 0, 0, 0, 2, 2,
                    0, 2, 0, 2, 1, 2, 2, 1, 2, 0, 0, 1,
                    2, 0, 2, 2, 2, 1, 2, 2, 0, 0, 2, 2,
                    2, 0, 2, 1, 1, 1, 0, 0, 2, 0, 1, 0,
                    1, 2, 1, 0, 2, 0, 0, 2, 1, 2, 1, 0,
                    2, 2, 0, 0, 2, 2, 2, 1, 0, 1, 2, 2,
                    0, 0, 0
                ];
                break;
            case '27':
                astroColsArray = [
                    0, 2, 0, 1, 0, 2, 2, 1, 2, 0, 2, 1,
                    1, 2, 1, 2, 2, 0, 2, 1, 2, 0, 0, 1,
                    2, 2, 2, 1, 0, 0, 2, 0, 0, 2, 0, 2,
                    1, 2, 2, 2, 1, 0, 1, 0, 1, 0, 0, 2,
                    2, 2, 0, 2, 2, 1, 0, 2, 1, 1, 0, 2,
                    2, 2, 0, 1, 2, 1, 2, 2, 2, 2, 0, 1,
                    0, 2, 0
                ];
                break;
            case '28':
                astroColsArray = [
                    0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 2,
                    0, 1, 2, 0, 2, 2, 2, 2, 2, 2, 2, 0,
                    0, 1, 0, 2, 2, 1, 1, 1, 2, 0, 0, 0,
                    2, 1, 1, 2, 0, 0, 0, 1, 2, 2, 1, 1,
                    0, 2, 2, 2, 2, 0, 2, 0, 2, 2, 1, 0,
                    2, 2, 0, 0, 0, 2, 1, 1, 0, 2, 0, 0,
                    0, 1, 2
                ];
                break;
            case '29':
                astroColsArray = [
                    1, 2, 0, 2, 2, 1, 0, 1, 0, 0, 0, 1,
                    1, 1, 0, 2, 0, 1, 2, 1, 0, 2, 2, 2,
                    2, 0, 1, 0, 2, 2, 2, 0, 0, 2, 0, 2,
                    1, 2, 2, 0, 0, 0, 1, 0, 2, 1, 2, 1,
                    2, 2, 1, 2, 2, 1, 2, 1, 1, 1, 1, 2,
                    2, 0, 2, 1, 2, 0, 1, 2, 1, 0, 1, 2,
                    0, 1, 0
                ];
                break;
            case '30':
                astroColsArray = [
                    0, 0, 0, 0, 1, 1, 2, 1, 0, 1, 1, 1,
                    2, 1, 1, 2, 1, 2, 2, 2, 2, 2, 2, 1,
                    2, 2, 2, 1, 1, 2, 2, 2, 1, 1, 0, 2,
                    1, 0, 2, 1, 0, 2, 0, 1, 0, 2, 1, 2,
                    0, 2, 0, 1, 1, 1, 1, 2, 1, 2, 1, 2,
                    1, 0, 0, 2, 2, 0, 2, 1, 0, 2, 2, 0,
                    1, 2, 0
                ];
                break;
            case '31':
                astroColsArray = [
                    2, 1, 2, 2, 2, 0, 1, 0, 2, 1, 0, 1,
                    2, 0, 2, 2, 2, 1, 2, 1, 2, 2, 1, 0,
                    0, 0, 0, 2, 2, 2, 2, 0, 2, 0, 0, 2,
                    2, 2, 2, 1, 2, 0, 0, 2, 2, 2, 2, 0,
                    0, 0, 2, 1, 2, 1, 0, 0, 2, 0, 2, 0,
                    0, 1, 1, 2, 2, 1, 1, 0, 2, 2, 2, 0,
                    2, 2, 2
                ];
                break;
            case '32':
                astroColsArray = [
                    0, 2, 2, 2, 0, 1, 1, 2, 2, 0, 2, 0,
                    2, 0, 1, 1, 1, 2, 2, 2, 0, 2, 2, 2,
                    2, 2, 1, 2, 1, 0, 2, 0, 1, 2, 2, 2,
                    0, 0, 2, 2, 2, 0, 0, 2, 0, 0, 2, 2,
                    1, 2, 1, 2, 2, 2, 0, 1, 1, 1, 2, 0,
                    1, 2, 1, 0, 2, 1, 2, 0, 1, 1, 0, 2,
                    2, 0, 2
                ];
                break;
            case '33':
                for (i = 0; i < 75; ++i) {
                    var num = Math.random();
                    if (num <= (1 / 3)) {
                        astroColsArray.push(0);
                    } else if (((1 / 3) < num) && (num <= (2 / 3))) {
                        astroColsArray.push(1);
                    } else {
                        astroColsArray.push(2);
                    }
                }
                console.log(astroColsArray);
                break;
            default:
                break;
        }
    </script>
</head>

<body>
    <div id="leveltemplatescreen">
        <div class="wallLeft" style="touch-action: manipulation;">
        </div>
        <div class="wallRight" style="touch-action: manipulation;">
        </div>
        <div id="finishedModal" class="modal" style="touch-action: manipulation;">
            <div class="modal-content" style="touch-action: manipulation;">
                <center style="touch-action: manipulation;">
                    <p class="modal-paragraph-1" style="touch-action: manipulation;">
                        Mission completed.
                        <br>
                        Setting route for nearest hangar.
                        <br>
                        Waiting for perimission to start travelling.
                    </p>
                    <button id="finishbutton" class="abortButton" onclick="closeFinishModalAndQuit();"
                        style="touch-action: manipulation;">
                        Grant permission
                    </button>
                </center>
            </div>
        </div>
        <div id="startModal" class="modal" style="touch-action: manipulation;">
            <div class="modal-content" style="touch-action: manipulation;">
                <center style="touch-action: manipulation;">
                    <p class="modal-paragraph-1" style="touch-action:manipulation;">
                        Spacecrafts are on position.
                        <br>
                        Deactivating stealth mode.
                        <br>
                        Waiting for permission to proceed.
                    </p>
                    <button id="proceedbutton" class="abortButton" onclick="closeModalAndStartGame();"
                        style="touch-action: manipulation;">
                        Proceed
                    </button>
                </center>
            </div>
        </div>
        <div id="myModal" class="modal" style="touch-action: manipulation;">
            <div class="modal-content" style="touch-action: manipulation;">
                <center style="touch-action: manipulation;">
                    <p id="modal-paragraph1" class="modal-paragraph-1" style="touch-action: manipulation;">
                        !!DANGER!!
                        <br>
                        Spacecraft collided with asteroid.
                        <br>
                        We've got casualties.
                        <br>
                        Aborting mission.
                        <br>
                        Asteroids destroyed:
                    </p>
                    <button id="abortbutton" class="abortButton" onclick="closeModalOnClickAndChangePage()"
                        style="touch-action: manipulation;">
                        Abort mission
                    </button>
                </center>
            </div>
        </div>
        <div id="gamearea" class="gameArea" style="touch-action: manipulation;">
            <div id="astroidarea" class="astroidArea" style="touch-action: manipulation;">
                <div id="column1astro" class="column1Astro" onclick="onClickColumn1();"
                    style="touch-action: manipulation;">
                </div>
                <div id="column2astro" class="column2Astro" onclick="onClickColumn2();"
                    style="touch-action: manipulation;">
                </div>
                <div id="column3astro" class="column3Astro" onclick="onClickColumn3();"
                    style="touch-action: manipulation;">
                </div>
                <script>
                    //create the boxes
                    var counter = 1;
                    var astroDiv1 = document.getElementById("column1astro");
                    var astroDiv2 = document.getElementById("column2astro");
                    var astroDiv3 = document.getElementById("column3astro");
                    for (const num of astroColsArray) {
                        if (num == 0) {
                            //creating element
                            var el = document.createElement("div");
                            var counters = counter.toString();
                            var id = "box" + counters;
                            //alert(id);
                            el.setAttribute("id", id);
                            el.classList.add("boxClass");
                            var topCoord = (-1) * (counter - 1) * 20 - 30;
                            var topCoords = topCoord.toString();
                            el.setAttribute("style", "top: " + topCoords + "px;");



                            ++counter;
                            astroDiv1.appendChild(el);
                            idsArray.push(id);
                            column1ids.push(id);
                        } else if (num == 1) {
                            //creating element
                            var el = document.createElement("div");
                            var counters = counter.toString();
                            var id = "box" + counters;
                            //alert(id);
                            el.setAttribute("id", id);
                            el.classList.add("boxClass");
                            var topCoord = (-1) * (counter - 1) * 20 - 30;
                            var topCoords = topCoord.toString();
                            el.setAttribute("style", "top: " + topCoords + "px;");



                            ++counter;
                            astroDiv2.appendChild(el);
                            idsArray.push(id);
                            column2ids.push(id);

                        } else if (num == 2) {
                            //creating element
                            var el = document.createElement("div");
                            var counters = counter.toString();
                            var id = "box" + counters;
                            //alert(id);
                            el.setAttribute("id", id);
                            el.classList.add("boxClass");
                            var topCoord = (-1) * (counter - 1) * 20 - 30;
                            var topCoords = topCoord.toString();
                            el.setAttribute("style", "top: " + topCoords + "px;");


                            ++counter;
                            astroDiv3.appendChild(el);
                            idsArray.push(id);
                            column3ids.push(id);

                        }
                    }
                </script>
            </div>
            <div id="bottomarea" class="bottomArea" style="touch-action: manipulation;">
                <div id="spacecraftarea" class="spaceCraftArea" style="touch-action: manipulation;">
                    <div id="columncraft1" class="columnCraft1" style="touch-action: manipulation;">
                        <div id="spacecraftcontainer1" class="spaceCraftContainer1" style="touch-action: manipulation;">
                            <img src="spaceshipimage.png" alt="spaceship1" class="spaceCraftImage" id="spacecraft1"
                                onclick="onClickColumn1();" style="touch-action: manipulation;">
                        </div>
                    </div>
                    <div id="columncraft2" class="columnCraft2" style="touch-action: manipulation;">
                        <div id="spacecraftcontainer2" class="spaceCraftContainer2" style="touch-action: manipulation;">
                            <img src="spaceshipimage.png" alt="spaceship2" class="spaceCraftImage" id="spacecraft2"
                                onclick="onClickColumn2();" style="touch-action: manipulation;">
                        </div>
                    </div>
                    <div id="columncraft3" class="columnCraft3" style="touch-action: manipulation;">
                        <div id="spacecraftcontainer3" class="spaceCraftContainer3" style="touch-action: manipulation;">
                            <img src="spaceshipimage.png" alt="spaceship3" class="spaceCraftImage" id="spacecraft3"
                                onclick="onClickColumn3();" style="touch-action: manipulation;">
                        </div>
                    </div>
                </div>
                <div id="statsarea" class="statsArea" style="touch-action: manipulation;">
                    <div id="splitter" class="splitter" style="touch-action: manipulation;">
                    </div>
                    <div class="splitter2" style="touch-action: manipulation;"></div>
                    <div class="splitter3" style="touch-action: manipulation;"></div>
                    <div class="splitter4" style="touch-action: manipulation;"></div>
                </div>
            </div>
        </div>
    </div>
    <script>

        var flag1 = true;
        var shouldIRun1 = true;
        var shouldIntervalRun1 = true;
        var isGameLoopRunning = false;
        var shouldFinishModalAppear = true;
        var spacecrafttop;
        var spacecraftmiddle;
        var toIncrement;
        //must be at least 2000sec because we have to wait for animation to finish
        setTimeout(() => {
            //just declaring some vars
            makeStartModalAppear();
            spacecrafttop = document.getElementById("spacecraft1").getBoundingClientRect().top;
            spacecraftmiddle = spacecrafttop + 22;
            toIncrement = spacecraftmiddle / 268.8515;
            console.log(toIncrement)
            //intervalThingy(shouldIntervalRun1, shouldIRun1);
            /*
            FOR DEBUGGING PURPOSES
            for(i=0;i<400;++i) {
                incrementTopForEveryElement();
            }*/
        }, 3500);

        //TO CONTINUE FROM HEREEEEEEEEEEEEEEEEEEE
        //for detecting keyboard press
        //this code should be modified
        window.onkeypress = function (evt) {
            evt = evt || window.event;
            var charCode = evt.keyCode || evt.which;
            var charStr = String.fromCharCode(charCode);
            //console.log(charStr);
            if ((charStr == "a") || (charStr == "A")) {
                onClickColumn1();
            } else if ((charStr == "s") || (charStr == "S")) {
                onClickColumn2();
            } else if ((charStr == "d") || (charStr == "D")) {
                onClickColumn3();
            }
        }

        function intervalThingy(intervalFlag, innerFlag) {
            var flagin = true;
            if (intervalFlag == true) {
                var drawer = setInterval(() => {
                    flagin = doesItCollide();
                    //console.log(flagin);
                    if (flagin == false) {
                        for (const id of idsArray) {
                            document.getElementById(id).stop();
                        }
                        setTimeout(() => {
                            makeFinishModalAppear();
                        }, 400);
                        clearInterval(drawer);
                    }
                }, 5);
            }
        }



        function incrementTopForEveryElement() {
            var collideCheck = false;
            var flag2 = true;
            if (idsArray.length == 0) {
                shouldIntervalRun1 = false;
                isGameLoopRunning = false;
                if (shouldFinishModalAppear == true) {
                    setTimeout(() => {
                        console.log(score.toString() + "/" + astroColsArray.length.toString());
                        makeFinishModalAppear();
                    }, 400);

                }
                //clearInterval(drawer);
                return false;
            }
            for (const id of idsArray) {
                collideCheck = doesItCollide(id);
                //console.log(isClear);
                //console.log(collideCheck);
                //console.log(retVal);
                if ((retVal == 1)) {
                    //clearInterval(drawer);
                    shouldIntervalRun1 = false;
                    isGameLoopRunning = false;
                    console.log(isGameLoopRunning);
                    alert("retval is 1");
                    return false;
                } else if (collideCheck == true) {
                    //clearInterval(drawer);
                    shouldIntervalRun1 = false;
                    isGameLoopRunning = false;
                    console.log(isGameLoopRunning);
                    console.log(score.toString() + "/" + astroColsArray.length.toString());
                    makeModalAppear();
                    //clearInterval(drawer);
                    return false;
                }
                incrementTop(id, toIncrement);
            }
            return true;
        }

        //here we write the function that checks
        //whether a block is upon the image
        function doesItCollide(id) {
            //getCoords of images
            var spacecraft1 = document.getElementById("spacecraft1").getBoundingClientRect();
            //get box bottom
            var box = document.getElementById(id).getBoundingClientRect();

            return !(
                ((spacecraft1.y + spacecraft1.height) < (box.y)) ||
                (spacecraft1.y > (box.y + box.height - 22))
                //stuff below here not needed
                //||
                /*((spacecraft1.x + spacecraft1.width) < box.x) ||
                (spacecraft1.x > (box.x + box.width))*/
            );
        }

        function closeModalOnClickAndChangePage() {
            var modal = document.getElementById("myModal");
            setTimeout(() => {
                modal.style.display = "none;"
            shouldIRun1 = false;
            window.history.back(1);
            shouldIntervalRun1 = false;
            clearInterval(drawer);
            }, 400);
            var audio = new Audio("sounds/clicksound358ms.mp3");
            audio.play();

        }

        function makeModalAppear() {
            var modal = document.getElementById("myModal");
            /*var modalParent = document.getElementById("forModal");
            modalParent.style.visibility = "";
            modalParent.style.zIndex = "";
            modalParent.style.visibility = "visible;"
            modalParent.style.zIndex = "999"
            modalParent.style.display = "block";*/
            document.getElementById("modal-paragraph1").innerHTML = document.getElementById("modal-paragraph1").innerHTML + (score.toString() + "/" + astroColsArray.length.toString());
            modal.style.display = "block";
        }

        function makeStartModalAppear() {
            var modal = document.getElementById("startModal");
            modal.style.display = "block";
        }

        function closeModalAndStartGame() {
            var modal = document.getElementById("startModal");
            setTimeout(() => {
                modal.style.display = "none";
                setTimeout(() => {
                    //intervalThingy(shouldIntervalRun1, shouldIRun1);
                    systemInit();
                }, 400);
            }, 400);
            var audio = new Audio("sounds/clicksound358ms.mp3");
            audio.play();

        }

        function makeFinishModalAppear() {
            var modal = document.getElementById("finishedModal");
            modal.style.display = "block";
        }

        function closeFinishModalAndQuit() {
            var modal = document.getElementById("finishedModal");
            modal.style.display = "none";
            setTimeout(() => {
                modal.remove();
                shouldFinishModalAppear = false;
                setTimeout(() => {
                    document.getElementById("spacecraftarea").classList.add("moveSpaceCraftAreaAway");
                    playGetAwayAudio();
                }, 400);
            }, 400);
            var audio = new Audio("sounds/clicksound358ms.mp3");
            audio.play();


            setTimeout(() => {
                window.history.back(1);
            }, 4000);

        }

        function onClickColumn1() {
            if (isGameLoopRunning == true) {
                if (column1ids.length != 0) {
                    var firstId = column1ids[0];
                    var firstelement = document.getElementById(firstId);
                    var indexInIds = idsArray.indexOf(firstId);

                    //creating a new div here for the flashing animation
                    var spacecrafty = document.getElementById("spacecraft1").getBoundingClientRect().y;
                    var div1 = document.getElementById("column1astro");
                    var temp = spacecrafty + 22;
                    var temps = temp.toString() + "px";
                    var shotDiv = document.createElement("div");
                    shotDiv.style.setProperty("width", "20px");
                    shotDiv.style.setProperty("background-color", "#343434");
                    shotDiv.style.setProperty("height", temps);
                    shotDiv.style.setProperty("top", "25px")
                    playShotAudio();
                    div1.appendChild(shotDiv);
                    setTimeout(() => {
                        shotDiv.remove();
                    }, 15);


                    idsArray.splice(indexInIds, 1)
                    //console.log(idsArray);
                    column1ids.shift();
                    firstelement.remove();
                    console.log("removed1");
                    ++score;
                } else {
                    console.log("nothing to remove");
                }
            } else {
                console.log("game not started");
            }
        }

        function onClickColumn2() {
            if (isGameLoopRunning == true) {
                if (column2ids.length != 0) {
                    var firstId = column2ids[0];
                    var firstelement = document.getElementById(firstId);
                    var indexInIds = idsArray.indexOf(firstId);

                    //creating a new div here for the flashing animation
                    var spacecrafty = document.getElementById("spacecraft2").getBoundingClientRect().y;
                    var div1 = document.getElementById("column2astro");
                    var temp = spacecrafty + 22;
                    var temps = temp.toString() + "px";
                    var shotDiv = document.createElement("div");
                    shotDiv.style.setProperty("width", "20px");
                    shotDiv.style.setProperty("background-color", "#343434");
                    shotDiv.style.setProperty("height", temps);
                    shotDiv.style.setProperty("top", "25px")
                    playShotAudio();
                    div1.appendChild(shotDiv);
                    setTimeout(() => {
                        shotDiv.remove();
                    }, 15);

                    idsArray.splice(indexInIds, 1);
                    //console.log(idsArray);
                    column2ids.shift();
                    firstelement.remove();
                    console.log("removed2");
                    ++score;
                } else {
                    console.log("nothing to remove");
                }
            } else {
                console.log("game not started");
            }
        }

        function onClickColumn3() {
            if (isGameLoopRunning == true) {

                if (column3ids.length != 0) {
                    var firstId = column3ids[0];
                    var firstelement = document.getElementById(firstId);
                    var indexInIds = idsArray.indexOf(firstId);
                    idsArray.splice(indexInIds, 1);

                    //creating a new div here for the flashing animation
                    var spacecrafty = document.getElementById("spacecraft3").getBoundingClientRect().y;
                    var div1 = document.getElementById("column3astro");
                    var temp = spacecrafty + 22;
                    var temps = temp.toString() + "px";
                    var shotDiv = document.createElement("div");
                    shotDiv.style.setProperty("width", "20px");
                    shotDiv.style.setProperty("background-color", "#343434");
                    shotDiv.style.setProperty("height", temps);
                    shotDiv.style.setProperty("top", "25px")
                    playShotAudio();
                    div1.appendChild(shotDiv);
                    setTimeout(() => {
                        shotDiv.remove();
                    }, 15);

                    //console.log(idsArray);
                    column3ids.shift();
                    firstelement.remove();
                    console.log("removed3");
                    ++score;
                } else {
                    console.log("nothing to remove");
                }
            } else {
                console.log("game not started");
            }
        }

        //IMPLEMENTING NEW DROPPING SYSTEM
        var shouldDrawLoopRun = false;
        var animationIds = [];

        function callDrawLoop() {
            shouldDrawLoopRun = true;
            //isGameLoopRunning = true;
            var numberdummy = DrawLoop();
        }

        function shouldIStop() {
            //check if there are elements on list
            //if there are not return false
            if (idsArray.length == 0) {
                //no elements
                isGameLoopRunning = false;
                shouldDrawLoopRun = false;
                if (shouldFinishModalAppear == true) {
                    setTimeout(() => {
                        console.log(score.toString() + "/" + astroColsArray.length.toString());
                        makeFinishModalAppear();
                    }, 400);

                }
                return false;
            }
            //check for collision
            for (const id of idsArray) {
                var collision = doesItCollide(id);
                if (collision == true) {
                    isGameLoopRunning = false;
                    shouldDrawLoopRun = false;
                    playCollisionAudio();
                    //appear modal
                    makeModalAppear();
                    //collision happened
                    return false;
                }
            }
            return true;
        }

        function animateEveryElement() {
            //here we animate every element
            //we use a timeout so that no function is called immediately
            setTimeout(() => {
                var spacecrafttop = document.getElementById("spacecraft1").getBoundingClientRect().top;
                var spacecraftmiddle = spacecrafttop + 2;
                var spacecraftmiddlestring = spacecraftmiddle.toString() + 'px';
                var box;
                var boxtop;
                var boxtopstring;
                var counter = 0;
                var delay; //= counter*177.28;
                var duration;// = 7960 + delay;
                var animid;
                for (const id of idsArray) {
                    box = document.getElementById(id);
                    boxtop = box.getBoundingClientRect().top;
                    boxtopstring = boxtop.toString() + 'px';
                    delay = counter * 136.302;
                    duration = 700 + delay;
                    animid = box.animate(
                        [
                            { top: boxtopstring },
                            { top: spacecraftmiddlestring }
                        ], {
                        delay: delay,
                        duration: duration,
                        easing: "linear",
                        fill: "forwards",
                        iteations: 1,
                    }
                    );
                    animationIds.push(animid);
                    if (counter == 0) {
                        isGameLoopRunning = true;
                    }
                    ++counter;
                }
            }, 100);
        }

        function DrawLoop() {
            var flag = true;
            var intthing = setInterval(() => {
                flag = shouldIStop();
                if (flag == false) {
                    EndProcedures();
                    clearInterval(intthing);
                    return 0;
                }
            }, 10);
        }

        function EndProcedures() {
            for (const animid of animationIds) {
                try {
                    animid.pause();
                } catch (error) {
                    console.log(error)
                } finally {
                    continue;
                }
            }
        }

        function systemInit() {
            callDrawLoop();
            animateEveryElement();
        }

        function playCollisionAudio() {
            var audio = new Audio("sounds/explosion2edited2sec.mp3");
            audio.play();
        }

        function playShotAudio() {
            var audio = new Audio("sounds/shotedited25ms.mp3");
            audio.play();
        }

        function playGetAwayAudio() {
            var audio = new Audio("sounds/helicopter3510ms.mp3");
            audio.play()
        }

    </script>
</body>

</html>